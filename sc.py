#!/usr/bin/env python3
from scapy.all import *
from dot11 import Dot11Parser

pkt_epol = \
	b"\x00\x00\x1a\x00\x2f\x48\x00\x00\x8f\xbf\x42\x5b\x00\x00\x00\x00" \
	b"\x00\x02\xa8\x09\xa0\x00\xd8\x00\x00\x00\x88\x02\x3a\x01\xd6\xdc" \
	b"\xea\x6d\x72\xee\xd2\xaf\x7d\x6e\x40\x2a\xd2\xaf\x7d\x6e\x40\x2a" \
	b"\x10\x00\x00\x00\xaa\xaa\x03\x00\x00\x00\x88\x8e\x02\x03\x00\x97" \
	b"\x02\x13\xca\x00\x10\x00\x00\x00\x00\x00\x00\x00\x02\x9e\x4b\x93" \
	b"\x57\x69\x3b\xbe\xc2\x6e\xa0\xce\x9d\x0b\x22\x7c\x1a\xa9\x28\xbd" \
	b"\xba\xb5\xb9\xf6\xa3\xe9\x8a\x29\x97\x1b\xf8\xd8\xf5\x00\x00\x00" \
	b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" \
	b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x52\x14\xcc" \
	b"\xe6\x91\x54\x89\xef\xd1\x0e\xce\x93\xb9\x6d\xb1\x66\x00\x38\x96" \
	b"\xc3\xb9\x57\xe0\xec\xb4\x58\x3a\xfc\xd6\xca\x63\x57\x71\x43\xa5" \
	b"\xce\xea\x07\x18\xa3\x5e\x71\x56\xef\xd3\xd4\xe2\xa5\x3f\x1c\x8c" \
	b"\xa3\x2b\x6b\x49\xe3\x20\x3d\x77\x12\x3b\x6d\xb8\x9f\xd1\xca\xf0" \
	b"\x95\xd7\xea\x54\x2c\x44\xfd"

tkip_qos_data = \
	b"\x00\x00\x15\x00\x2a\x48\x08\x00\x00\x00\xa8\x09\x80\x04\xb9\x01" \
	b"\x00\x00\x07\x00\x01\x88\x41\x3c\x00\x88\xd7\xf6\x5e\xd0\x40\xea" \
	b"\x05\xae\xb2\xb0\x66\x88\xd7\xf6\x5e\xd0\x40\xd0\x30\x00\x00\x13" \
	b"\x33\x00\x20\x00\x00\x00\x00\x9f\x78\xe7\x78\x17\x15\x5b\x3d\x78" \
	b"\x7e\xee\xe5\x3e\x8f\x41\xa8\x39\x94\x6c\x68\x24\xaf\x54\x11\xae" \
	b"\x29\xd2\xf6\xbe\x97\x72\x1d\xa1\xa7\x40\xf4\x64\x74\xac\xbc\x63" \
	b"\xd5\x5b\xf4\x7d\xe7\x30\x32\x19\x3a\xbe\x07\x34\x6f\x05\x97\xdf" \
	b"\x5b\xbf\x89\xb6\xfe\x76\xf6\xcc\x49\x0a\x71"

ccmp_qos_data = \
	b"\x00\x00\x12\x00\x2e\x48\x00\x00\x00\x02\x9e\x09\xa0\x00\xcb\x01" \
	b"\x00\x00\x88\x41\x7a\x01\xc4\x6e\x1f\x7f\x69\x6a\xc0\xe7\xbf\x45" \
	b"\x66\x60\xff\xff\xff\xff\xff\xff\x30\x25\x00\x00\xe5\x7a\x00\x20" \
	b"\x01\x00\x00\x00\x0e\x9e\x0a\x0e\xfe\xe8\x96\x5c\x82\x12\x3e\x66" \
	b"\x59\xdd\xf4\xfd\xff\x8a\x13\xa8\xcc\x66\x64\x8f\x3b\x1b\x22\xa8" \
	b"\x3c\xb3\x5a\x6f\x98\xe0\x23\xd7\x0b\xc8\x10\x83\xfb\x91\x0d\xd6" \
	b"\x9a\x1e\xbd\xc3\xbd\x11\xc0\x3c\x7e\x4d\xc1\x9d\x3b\x32\x50\x70" \
	b"\xac\x71"


beacon_frame = \
	b"\x00\x00\x12\x00\x2e\x48\x00\x00\x00\x02\x9e\x09\xa0\x00\xbf\x01" \
	b"\x00\x00\x80\x00\x00\x00\xff\xff\xff\xff\xff\xff\x08\xf4\x58\x83" \
	b"\x00\x21\x08\xf4\x58\x83\x00\x21\x30\xb4\xa6\x11\xaa\x9c\x35\x00" \
	b"\x00\x00\x64\x00\x31\x14\x00\x00\x01\x08\x82\x84\x8b\x0c\x12\x96" \
	b"\x18\x24\x03\x01\x0b\x05\x04\x00\x01\x00\x00\x23\x02\x1e\x00\x46" \
	b"\x05\x03\x02\x00\x00\x00\x2a\x01\x03\x30\x14\x01\x00\x00\x0f\xac" \
	b"\x04\x01\x00\x00\x0f\xac\x04\x01\x00\x00\x0f\xac\x02\x0c\x00\xdd" \
	b"\x18\x00\x50\xf2\x02\x01\x01\x80\x00\x03\xa4\x00\x00\x27\xa4\x00" \
	b"\x00\x42\x43\x5e\x00\x62\x32\x2f\x00\x32\x04\x30\x48\x60\x6c\x0b" \
	b"\x05\x00\x00\x4c\x12\x7a\x2d\x1a\xed\x01\x03\xff\xff\x00\x00\x00" \
	b"\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00" \
	b"\x00\x00\x3d\x16\x0b\x00\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00" \
	b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4a\x0e\x14\x00\x0a\x00" \
	b"\x2c\x01\xc8\x00\x14\x00\x05\x00\x19\x00\x7f\x08\x01\x00\x08\x00" \
	b"\x00\x00\x00\x40\xbf\x0c\x92\x79\x19\x03\xfa\xff\xd8\x00\xfa\xff" \
	b"\xd8\x20\xc0\x05\x00\x00\x00\xfa\xff\xff\x16\x23\x01\x08\x08\x1e" \
	b"\x00\x58\x00\x2f\x4e\xc9\x6f\xc9\x27\xde\x01\x8f\x00\xfa\xff\xfa" \
	b"\xff\xff\x07\x24\xe4\x3f\x00\x01\xfc\xff\xff\x03\x27\x05\x00\xff" \
	b"\x0e\x26\x00\x00\xff\xff\x20\xff\xff\x40\xff\xff\x60\xff\xff\xff" \
	b"\x02\x25\x2a\xdd\x08\xac\x85\x3d\x82\x01\x00\x00\x00\xdd\x08\x00" \
	b"\xe0\xfc\x81\xf1\x0e\x04\x00\xdd\x23\x00\x50\xf2\x04\x10\x4a\x00" \
	b"\x01\x10\x10\x44\x00\x01\x02\x10\x08\x00\x02\x07\x80\x10\x3c\x00" \
	b"\x01\x01\x10\x49\x00\x06\x00\x37\x2a\x00\x01\x20\xdd\x04\xac\x85" \
	b"\x3d\xbd\xdd\x0f\x00\xe0\xfc\x40\x00\x00\x00\x00\x00\xfd\x04\x80" \
	b"\x00\x00\x00"



dp = Dot11Parser(beacon_frame)
b = dp.return_Dot11_Beacon()
print(b)

#print(dp.return_RadioTap_PresentsFlags())
#print(dp.return_dot11_addrs())