#!/usr/bin/env python3
import struct
import pcap

interface = "radio0mon"

ieee80211_radiotap_presents_sizes_aligns = {
	'IEEE80211_RADIOTAP_TSFT': {'size': 8, 'align': 8},
	'IEEE80211_RADIOTAP_Flags': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_Rate': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_Channel': {'size': 4, 'align': 2},
	'IEEE80211_RADIOTAP_FHSS': {'size': 2, 'align': 2},
	'IEEE80211_RADIOTAP_dbm_Antenna_Signal': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_dbm_Antenna_Noise': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_Lock_Quality': {'size': 2, 'align': 2},
	'IEEE80211_RADIOTAP_TX_Attenuation': {'size': 2, 'align': 2},
	'IEEE80211_RADIOTAP_db_TX_Attenuation': {'size': 2, 'align': 2},
	'IEEE80211_RADIOTAP_dbm_TX_Power': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_Antenna': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_db_Antenna_Signal': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_db_Antenna_Noise': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_RX_Flags': {'size': 2, 'align': 2},
	'IEEE80211_RADIOTAP_TX_Flags': {'size': 2, 'align': 2},
	'IEEE80211_RADIOTAP_RTS_retries': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_Data_retries': {'size': 1, 'align': 1},
	'IEEE80211_RADIOTAP_MCS': {'size': 3, 'align': 1},
	'IEEE80211_RADIOTAP_A_MPDU_Status': {'size': 8, 'align': 4},
	'IEEE80211_RADIOTAP_VHT_Info': {'size': 12, 'align': 2},
	'IEEE80211_RADIOTAP_Frame_timestamp': {'size': 12, 'align': 8},
}
pkt = \
	b"\x00\x00\x12\x00\x2e\x48\x00\x00\x00\x02\x8a\x09\xa0\x00\xbf\x01" \
	b"\x00\x00\x80\x00\x00\x00\xff\xff\xff\xff\xff\xff\x40\xed\x00\x62" \
	b"\x31\x74\x40\xed\x00\x62\x31\x74\xe0\x6e\x3f\xe3\x47\x20\x80\x00" \
	b"\x00\x00\x64\x00\x31\x1c\x00\x0c\x54\x50\x2d\x4c\x69\x6e\x6b\x5f" \
	b"\x33\x31\x37\x34\x01\x08\x82\x84\x8b\x96\x12\x24\x48\x6c\x03\x01" \
	b"\x07\x05\x04\x00\x01\x00\x00\x07\x06\x52\x55\x20\x01\x0d\x23\x20" \
	b"\x01\x00\x23\x02\x3f\x00\xc3\x02\x00\x7e\x46\x05\x72\x00\x01\x00" \
	b"\x00\x33\x0a\x0b\x01\x02\x03\x04\x05\x06\x07\x08\x09\x2a\x01\x00" \
	b"\x32\x04\x0c\x18\x30\x60\x30\x14\x01\x00\x00\x0f\xac\x04\x01\x00" \
	b"\x00\x0f\xac\x04\x01\x00\x00\x0f\xac\x02\x00\x00\xdd\x31\x00\x50" \
	b"\xf2\x04\x10\x4a\x00\x01\x10\x10\x44\x00\x01\x02\x10\x47\x00\x10" \
	b"\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x40\xed\x00\x62\x31\x74" \
	b"\x10\x3c\x00\x01\x03\x10\x49\x00\x06\x00\x37\x2a\x00\x01\x20\x2d" \
	b"\x1a\xef\x11\x17\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" \
	b"\x00\x00\x00\x00\x00\x00\x18\x04\x87\x09\x00\x3d\x16\x07\x00\x00" \
	b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" \
	b"\x00\x00\x00\x4a\x0e\x14\x00\x0a\x00\x2c\x01\xc8\x00\x14\x00\x05" \
	b"\x00\x19\x00\xbf\x0c\xb1\x79\xc9\x33\xfa\xff\x0c\x03\xfa\xff\x0c" \
	b"\x03\xc0\x05\x00\x00\x00\xfa\xff\x7f\x08\x01\x00\x08\x00\x00\x00" \
	b"\x00\x00\xdd\x18\x00\x50\xf2\x02\x01\x01\x80\x00\x03\xa4\x00\x00" \
	b"\x27\xa4\x00\x00\x42\x43\x5e\x00\x62\x32\x2f\x00\xdd\x07\x00\x0c" \
	b"\x43\x09\x00\x00\x00\xdd\x21\x00\x0c\xe7\x08\x00\x00\x00\xbf\x0c" \
	b"\xb1\x01\xc0\x33\x2a\xff\x92\x04\x2a\xff\x92\x04\xc0\x05\x00\x00" \
	b"\x00\x2a\xff\xc3\x03\x01\x02\x02"

def return_RadioTap_Header(pkt):
	it_version, it_pad, it_len, it_present = struct.unpack_from('<BBHI', pkt, 0)
	return {
		'it_version': it_version,
		'it_pad': it_pad,
		'it_len': it_len,
		'it_present': it_present,
	}

def return_RadioTap_presents(pkt):
	rt_header = return_RadioTap_Header(pkt)
	rt_presents_offset = 4
	

return_RadioTap_presents(pkt)

def packet_handler(ts, pkt):
	if b'\xa8\x63\x7d\xe3\x01\x12' in pkt:
		for i in range(len(pkt)):
			print(f'\\x{pkt[i]:02x}', end="")
	print("\n\n")
#pc = pcap.pcap(name=interface, immediate=True)
#pc.loop(0, packet_handler)
